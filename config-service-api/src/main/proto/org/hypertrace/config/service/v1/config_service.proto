syntax = "proto3";

option java_multiple_files = true;

package org.hypertrace.config.service.v1;

import "google/protobuf/struct.proto";

service ConfigService {
  rpc UpsertConfig(UpsertConfigRequest) returns (UpsertConfigResponse) {}
  rpc GetConfig(GetConfigRequest) returns (GetConfigResponse) {}
}

message UpsertConfigRequest {
  string resource_name = 1;  // required
  string resource_namespace = 2;  // required - name of the service with which the config resource is associated
  google.protobuf.Value config = 3;
  string context = 4; // optional - only required if config applies to a specific context
}

message UpsertConfigResponse {
  bool success = 1;
  string message = 2;
  int64 config_version = 3;
}

message GetConfigRequest {
  string resource_name = 1;  // required
  string resource_namespace = 2;  // required - name of the service with which the config resource is associated
  int64 config_version = 3; //optional - if absent, get the config with latest version
  repeated string contexts = 4; // optional; order matters - specify the contexts in the order of increasing priority. Example: ["service1", "api1"]
}

message GetConfigResponse {
  google.protobuf.Value config = 1;
}
